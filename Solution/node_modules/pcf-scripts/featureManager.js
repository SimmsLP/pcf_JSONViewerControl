"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FeatureManager = void 0;
const node_fs_1 = require("node:fs");
const path = require("node:path");
const constants = require("./constants");
// eslint-disable-next-line @typescript-eslint/no-require-imports
const buildFlags = require("./featureflags.json");
class FeatureManager {
    constructor() {
        const configPath = path.resolve(".", constants.FEATURE_CONFIG_FILE_NAME);
        let featureOverrides = {};
        try {
            if ((0, node_fs_1.existsSync)(configPath)) {
                const featureConfig = (0, node_fs_1.readFileSync)(configPath);
                featureOverrides = JSON.parse(featureConfig.toString());
            }
        }
        catch (error) {
            console.error(`[FeatureManager] [Error] Error reading feature configuration from ${configPath}:\n${error}`);
        }
        this._featureFlags = Object.entries(buildFlags).reduce((acc, [key, value]) => {
            acc[key] = featureOverrides[key] ?? value;
            return acc;
        }, {});
    }
    isFeatureEnabled(feature) {
        return this._featureFlags[feature] === "on";
    }
}
exports.FeatureManager = FeatureManager;

//# sourceMappingURL=featureManager.js.map
